# =================================================================
# APPLICATION CONFIGURATION
# =================================================================

NODE_ENV=development
LOG_LEVEL=debug
LOGS_DIAGNOSTICS_DATA_POLICY=conceal
PORT=9542

# =================================================================
# SHAREPOINT / MICROSOFT GRAPH CONFIGURATION
# =================================================================

# Which authentication mode we use for Microsoft APIs - can be certificate, oidc or client-secret
# Depending on this variable, other authentication variables may become required
# Possible values: oidc, client-secret, certificate
SHAREPOINT_AUTH_MODE=certificate
SHAREPOINT_AUTH_TENANT_ID=your-azure-tenant-id # Always required

# Required for both certificate and client secret auth
SHAREPOINT_AUTH_CLIENT_ID=your-azure-app-client-id

# Required for client-secret auth mode
SHAREPOINT_AUTH_CLIENT_SECRET=your-azure-app-client-secret

# Required for certificate auth mode
# Path to the private key file of the Azure AD application certificate in PEM format
SHAREPOINT_AUTH_PRIVATE_KEY_PATH=/path/to/key.pem
# Passpharse for the key above if it is encrypted (optional but recommended)
SHAREPOINT_AUTH_PRIVATE_KEY_PASSWORD=key-password
# Certificate thumbprint either as 
# X.509 SHA-1 or X.509 SHA-256 thumbprint of the certificate in hex format without colons. Only one
# of them has to be provided.
# SHAREPOINT_AUTH_THUMBPRINT_SHA1=96C3BD4333A870D3703C89F5F1D554B4CDF5319F
SHAREPOINT_AUTH_THUMBPRINT_SHA256=B34D6560CE00ABC4264477B1FC901BF3710BCB50A2768FB77FBCA580557D8ABA

# Optional, defaults to 780000 requests per minute
SHAREPOINT_GRAPH_API_RATE_LIMIT_PER_MINUTE=780000

SHAREPOINT_BASE_URL=https://uniqueapp.sharepoint.com
SHAREPOINT_SITE_IDS=sharepoint-site-id-1,sharepoint-site-id-2
SHAREPOINT_SYNC_COLUMN_NAME=FinanceGPTKnowledge

# =================================================================
# UNIQUE API CONFIGURATION
# =================================================================

UNIQUE_SERVICE_AUTH_MODE=cluster_local
UNIQUE_SERVICE_EXTRA_HEADERS='{"x-company-id": "company-123", "x-user-id": "service-user"}'

UNIQUE_SCOPE_ID=your-scope-id
UNIQUE_INGESTION_SERVICE_BASE_URL=http://node-ingestion.finance-gpt:8091
UNIQUE_SCOPE_MANAGEMENT_SERVICE_BASE_URL=http://node-scope-management.finance-gpt:8094
UNIQUE_API_RATE_LIMIT_PER_MINUTE=20
UNIQUE_INGESTION_MODE=recursive
UNIQUE_MAX_INGESTED_FILES=1000
UNIQUE_STORE_INTERNALLY=disabled
# Comma-separated list of inheritance options for generated scopes and ingested files in content_only mode
# Possible values: none, inherit_scopes, inherit_files
# When empty or unset, both scopes and files inherit in content_only mode; ignored in content_and_permissions mode
UNIQUE_INHERIT_MODES=inherit_scopes,inherit_files

ZITADEL_OAUTH_TOKEN_URL=https://id.qa.unique.app/oauth/v2/token
ZITADEL_PROJECT_ID="your-zitadel-project-id"
ZITADEL_CLIENT_ID=your-zitadel-client-id@your-domain.com
ZITADEL_CLIENT_SECRET=your-zitadel-client-secret

# =================================================================
# FILES PROCESSING CONFIGURATION
# =================================================================

# What should be synced from SharePoint. Options are:
# - content_only: when we sync all the content, but ignore permissions
# - content_and_permissions: when we sync both content, groups and file permissions
PROCESSING_SYNC_MODE=content_only
PROCESSING_SCAN_INTERVAL_CRON='*/15 * * * *'
PROCESSING_STEP_TIMEOUT_SECONDS=300
PROCESSING_CONCURRENCY=1
PROCESSING_MAX_FILE_SIZE_BYTES=209715200
PROCESSING_ALLOWED_MIME_TYPES=application/pdf,application/vnd.openxmlformats-officedocument.wordprocessingml.document
# Used only for testing purpose to limit the amount of files we scan and ingest
#PROCESSING_MAX_FILES_TO_SCAN=2

# =================================================================
# MONITORING CONFIGURATION
# =================================================================

# OpenTelemetry Configuration (for Prometheus metrics)
OTEL_METRICS_EXPORTER=prometheus
OTEL_EXPORTER_PROMETHEUS_HOST=localhost
OTEL_EXPORTER_PROMETHEUS_PORT=8081

# =================================================================
# HAIRPINNING OPTIMIZATION - Optional for In-Cluster Communication
# =================================================================
# To avoid hairpinning, configure internal Kubernetes service URLs

# UNIQUE_ZITADEL_OAUTH_TOKEN_URL=http://zitadel.<namespace>.svc.cluster.local:8080/oauth/v2/token

# UNIQUE_SCOPE_MANAGEMENT_GRAPHQL_URL=http://scope-management.<namespace>.svc.cluster.local:8080/graphql
# UNIQUE_INGESTION_GRAPHQL_URL=http://ingestion.<namespace>.svc.cluster.local:8080/graphql
# UNIQUE_FILE_DIFF_URL=http://ingestion.<namespace>.svc.cluster.local:8080/v2/content/file-diff

# Extra HTTP headers for Ingestion API requests (JSON format)
UNIQUE_SERVICE_EXTRA_HEADERS='{"x-company-id": "company-123", "x-user-id": "service-user"}'

{
  "$schema": "https://json-schema.org/draft-07/schema#",
  "type": "object",
  "properties": {
    "connector": {
      "type": "object",
      "description": "Configuration for the backend-service dependency",
      "additionalProperties": true
    },
    "grafana": {
      "type": "object",
      "description": "Grafana dashboard configuration",
      "properties": {
        "dashboard": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "boolean",
              "description": "Enable Grafana dashboard creation"
            },
            "folder": {
              "type": "string",
              "description": "Grafana folder name for the dashboard"
            }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    },
    "connectorConfig": {
      "type": "object",
      "description": "SharePoint connector configuration",
      "required": ["enabled", "sharepoint", "unique", "processing"],
      "properties": {
        "enabled": {
          "type": "boolean",
          "description": "Wether to use the connector config."
        },
        "sharepoint": {
          "type": "object",
          "description": "SharePoint configuration",
          "required": ["baseUrl", "siteIds", "syncColumnName", "graph"],
          "properties": {
            "baseUrl": {
              "type": "string",
              "description": "SharePoint base URL",
              "examples": [
                "https://contoso.sharepoint.com",
                "https://my-company.sharepoint.com"
              ]
            },
            "siteIds": {
              "type": "array",
              "items": {
                "type": "string",
                "examples": ["00000000-0000-0000-0000-000000000000"]
              },
              "description": "SharePoint sites list (UUIDs)",
              "examples": [["00000000-0000-0000-0000-000000000000"]]
            },
            "syncColumnName": {
              "type": "string",
              "description": "Column name for synchronization",
              "examples": ["FinanceGPTKnowledge", "MyCustomColumn"]
            },
            "auth": {
              "type": "object",
              "description": "SharePoint authentication configuration",
              "required": ["mode", "tenantId"],
              "properties": {
                "mode": {
                  "type": "string",
                  "description": "Authentication mode",
                  "enum": ["oidc", "client-secret", "certificate"]
                },
                "tenantId": {
                  "type": "string",
                  "description": "Azure AD tenant ID",
                  "examples": ["00000000-0000-0000-0000-000000000000"]
                },
                "clientId": {
                  "type": ["string", "null"],
                  "description": "Azure AD application client ID",
                  "examples": ["00000000-0000-0000-0000-000000000000"]
                },
                "clientSecret": {
                  "type": ["string", "null"],
                  "description": "Azure AD application client secret"
                },
                "privateKeyPath": {
                  "type": ["string", "null"],
                  "description": "Path to the private key file of the Azure AD application certificate in PEM format",
                  "examples": ["/app/key.pem", "/my/custom/mount/path/key.pem"]
                },
                "privateKeyPassword": {
                  "type": ["string", "null"],
                  "description": "Password for the private key file of the Azure AD application certificate (if the key is encrypted)"
                },
                "thumbprintSha1": {
                  "type": ["string", "null"],
                  "description": "SHA1 thumbprint of the Azure AD application certificate",
                  "examples": ["2fd4e1c67a2d28fced849ee1bb76e7391b93eb12"]
                },
                "thumbprintSha256": {
                  "type": ["string", "null"],
                  "description": "SHA256 thumbprint of the Azure AD application certificate"
                }
              },
              "additionalProperties": false
            },
            "graph": {
              "type": "object",
              "description": "Microsoft Graph API configuration",
              "required": [],
              "properties": {
                "apiRateLimitPerMinute": {
                  "type": "integer",
                  "description": "Rate limiting for Graph API requests per minute"
                },
                "additionalProperties": false
              },
              "additionalProperties": false
            }
          },
          "additionalProperties": false
        },
        "unique": {
          "type": "object",
          "description": "Unique platform configuration",
          "required": [
            "fileDiffUrl",
            "ingestionGraphqlUrl",
            "scopeManagementGraphqlUrl",
            "ingestionMode",
            "authMode"
          ],
          "properties": {
            "fileDiffUrl": {
              "type": "string",
              "description": "URL for file differences",
              "examples": [
                "http://node-ingestion.finance-gpt:8091/v2/content/file-diff",
                "https://api.unique.app/ingestion/v2/content/file-diff"
              ]
            },
            "ingestionGraphqlUrl": {
              "type": "string",
              "description": "GraphQL URL for data ingestion",
              "examples": [
                "http://node-ingestion.finance-gpt:8091/graphql",
                "https://api.unique.app/ingestion/graphql"
              ]
            },
            "scopeManagementGraphqlUrl": {
              "type": "string",
              "description": "GraphQL URL for scope management",
              "examples": [
                "http://node-scope-management.finance-gpt:8094/graphql",
                "https://api.unique.app/scope-management/graphql"
              ]
            },
            "ingestionMode": {
              "type": "string",
              "enum": ["flat", "recursive"],
              "description": "Synchronization mode: flat or recursive"
            },
            "rootScopeName": {
              "type": ["string", "null"],
              "description": "Name of the root scope/folder in the knowledge base where SharePoint content should be synced"
            },
            "scopeId": {
              "type": ["string", "null"],
              "description": "Scope ID for scope based ingestion"
            },
            "apiRateLimitPerMinute": {
              "type": "integer",
              "description": "Rate limiting for Unique API requests per minute"
            },
            "storeInternally": {
              "type": "string",
              "enum": ["enabled", "disabled"],
              "description": "Whether to store content internally in Unique or not."
            },
            "authMode": {
              "type": "string",
              "enum": ["cluster_local", "external"],
              "description": "Communication mode for the Unique Services"
            },
            "serviceExtraHeaders": {
              "type": ["object"],
              "description": "HTTP extra headers for ingestion API requests",
              "examples": [
                {
                  "x-company-id": "123456789101112131",
                  "x-user-id": "123456789101112131"
                }
              ]
            },
            "zitadel": {
              "type": "object",
              "description": "Zitadel authentication configuration",
              "required": ["clientId", "oauthTokenUrl", "projectId"],
              "properties": {
                "clientId": {
                  "type": "string",
                  "description": "Zitadel client ID",
                  "examples": ["sharepoint-connector@idp.unique.app"]
                },
                "clientSecret": {
                  "type": "string",
                  "description": "Zitadel client secret"
                },
                "oauthTokenUrl": {
                  "type": "string",
                  "description": "OAuth token URL",
                  "examples": ["https://idp.unique.app/oauth/v2/token"]
                },
                "projectId": {
                  "type": "string",
                  "description": "Zitadel project ID",
                  "examples": ["123456789101112131"]
                },
                "serviceExtraHeaders": {
                  "type": ["object"],
                  "description": "HTTP extra headers for Zitadel OAuth requests",
                  "examples": [
                    {
                      "x-zitadel-instance-host": "idp.unique.app"
                    }
                  ]
                }
              },
              "additionalProperties": false
            }
          },
          "additionalProperties": false
        },
        "processing": {
          "type": "object",
          "description": "Files processing configuration",
          "required": ["allowedMimeTypes", "concurrency", "syncMode"],
          "properties": {
            "syncMode": {
              "type": "string",
              "enum": ["content_only", "content_and_permissions"],
              "description": "Mode of synchronization from SharePoint to Unique",
              "examples": [
                "content_only",
                "content_and_permissions"
              ]
            },
            "allowedMimeTypes": {
              "type": "array",
              "items": {
                "type": "string",
                "examples": [
                  "application/pdf",
                  "application/vnd.openxmlformats-officedocument.wordprocessingml.document"
                ]
              },
              "description": "List of allowed MIME types for file processing",
              "examples": [
                [
                  "application/pdf",
                  "application/vnd.openxmlformats-officedocument.wordprocessingml.document"
                ]
              ]
            },
            "concurrency": {
              "type": "integer",
              "description": "Number of concurrent processing operations"
            },
            "stepTimeoutSeconds": {
              "type": "integer",
              "description": "Timeout in seconds for processing steps"
            },
            "maxFilesToScan": {
              "type": "integer",
              "description": "Maximum number of files to scan"
            },
            "maxFileSizeBytes": {
              "type": ["integer", "null"],
              "description": "Maximum number of files to scan"
            },
            "scanIntervalCron": {
              "type": "string",
              "description": "Cron expression for the scheduled SharePoint scan interval",
              "examples": ["*/15 * * * *"]
            }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    }
  },
  "additionalProperties": false
}

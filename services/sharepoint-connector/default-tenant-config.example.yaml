# SharePoint Connector Tenant Configuration Example
# This file contains all configuration options for the SharePoint connector.
# Copy this file and customize it for your tenant.

# ============================================================================
# SharePoint Configuration
# ============================================================================
sharepoint:
  # Authentication mode: 'oidc', 'client-secret', or 'certificate'
  authMode: certificate
  
  # Azure AD tenant ID (required for all auth modes)
  authTenantId: your-tenant-id-here
  
  # Client ID (required for 'client-secret' and 'certificate' modes)
  authClientId: your-client-id-here
  
  # Client secret (required only for 'client-secret' mode)
  # authClientSecret: your-client-secret-here
  
  # Certificate authentication (required only for 'certificate' mode)
  authPrivateKeyPath: /path/to/private-key.pem
  authThumbprintSha1: your-sha1-thumbprint-here
  # authThumbprintSha256: your-sha256-thumbprint-here
  
  # Note: If private key is encrypted, provide password via environment variable:
  # - Local dev: Add SHAREPOINT_AUTH_PRIVATE_KEY_PASSWORD to .env file
  # - Kubernetes: Load from secret via envVars (see values.yaml)
  
  # Your company's SharePoint base URL (without trailing slash)
  baseUrl: https://yourcompany.sharepoint.com
  
  # Number of MS Graph API requests allowed per minute (optional, default: 600)
  graphApiRateLimitPerMinute: 600
  
  # ============================================================================
  # Sites Configuration
  # Each site can have its own sync settings
  # ============================================================================
  sites:
    # Example Site 1: Finance site with recursive ingestion
    - siteId: 12345678-1234-1234-1234-123456789abc
      syncColumnName: FinanceGPTKnowledge
      ingestionMode: recursive
      scopeId: scope_bu4gokr0atzj0kfiuaaaaaaa
      maxIngestedFiles: 1000
      storeInternally: enabled
      syncStatus: active
      syncMode: content_and_permissions
    
    # Example Site 2: HR site with flat ingestion
    - siteId: 87654321-4321-4321-4321-cba987654321
      syncColumnName: HRKnowledge
      ingestionMode: flat
      scopeId: scope_bu4gokr0atzj0kfiubbbbbb
      maxIngestedFiles: 500
      storeInternally: enabled
      syncStatus: active
      syncMode: content_only
    
    # Example Site 3: Inactive site (will be skipped)
    - siteId: aabbccdd-1111-2222-3333-444444444444
      syncColumnName: OldSiteColumn
      ingestionMode: recursive
      scopeId: scope_bu4gokr0atzj0kfiuccccccc
      storeInternally: enabled
      syncStatus: inactive
      syncMode: content_only

# ============================================================================
# Unique API Configuration
# ============================================================================
unique:
  # Authentication mode: 'cluster_local' or 'external'
  serviceAuthMode: cluster_local
  
  # For 'cluster_local' mode: Extra headers for in-cluster communication
  serviceExtraHeaders:
    x-company-id: your-company-id
    x-user-id: your-user-id
  
  # For 'external' mode: Zitadel authentication settings
  # serviceAuthMode: external
  # zitadelOauthTokenUrl: https://your-zitadel-instance.com/oauth/v2/token
  # zitadelProjectId: your-project-id
  # zitadelClientId: your-client-id
  # Note: zitadelClientSecret must be provided via environment variable:
  # - Local dev: Add ZITADEL_CLIENT_SECRET to .env file
  # - Kubernetes: Load from secret via envVars (see values.yaml)
  
  # Base URL for Unique ingestion service (without trailing slash)
  ingestionServiceBaseUrl: https://ingestion.your-unique-instance.com
  
  # Base URL for Unique scope management service (without trailing slash)
  scopeManagementServiceBaseUrl: https://scope-management.your-unique-instance.com
  
  # Number of Unique API requests allowed per minute (optional, default: 60)
  apiRateLimitPerMinute: 60
  
  # Optional: Config object to pass when submitting file for ingestion
  # ingestionConfig:
  #   uniqueIngestionMode: SKIP_INGESTION
  #   customProperty: value

# ============================================================================
# Processing Configuration
# ============================================================================
processing:
  # Time limit for a file processing step in seconds (default: 300)
  stepTimeoutSeconds: 300
  
  # Concurrency: how many files to ingest at once (default: 5)
  concurrency: 5
  
  # Maximum file size in bytes to ingest (default: 52428800 = 50MB)
  maxFileSizeBytes: 52428800
  
  # Allowed MIME types for files to sync (can be array or comma-separated string)
  allowedMimeTypes:
    - application/pdf
    - application/vnd.openxmlformats-officedocument.wordprocessingml.document
    - application/vnd.openxmlformats-officedocument.spreadsheetml.sheet
    - application/vnd.openxmlformats-officedocument.presentationml.presentation
  
  # For testing: maximum number of files to scan (optional, unlimited if not set)
  # maxFilesToScan: 100
  
  # Cron expression for the scheduled file scan interval (default: every 15 minutes)
  scanIntervalCron: "*/15 * * * *"

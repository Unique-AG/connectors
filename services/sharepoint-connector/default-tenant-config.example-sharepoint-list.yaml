# SharePoint Connector - Dynamic Configuration Example
# Sites are loaded from a SharePoint list

sharepoint:
  auth:
    mode: certificate
    tenantId: your-tenant-id-here
    clientId: your-client-id-here
    privateKeyPath: /path/to/private-key.pem
    thumbprintSha1: your-sha1-thumbprint-here
  baseUrl: https://yourcompany.sharepoint.com
  graphApiRateLimitPerMinute: 600
  
  # Sites configuration from SharePoint list
  sitesSource: sharepoint_list
  sharepointListUrl: https://yourcompany.sharepoint.com/sites/ConfigSite/Lists/SharePoint%20Sites%20to%20Sync/AllItems.aspx
  
  # Required SharePoint list columns:
  # - syncSiteId (Single line text) - SharePoint site ID
  # - syncColumnName (Single line text) - Column that marks files for sync
  # - ingestionMode (Choice: flat, recursive)
  # - uniqueScopeId (Single line text) - Unique scope ID
  # - maxFilesToIngest (Number, optional)
  # - storeInternally (Choice: enabled, disabled)
  # - syncStatus (Choice: active, inactive, deleted)
  # - syncMode (Choice: content_only, content_and_permissions)

unique:
  serviceAuthMode: cluster_local
  serviceExtraHeaders:
    x-company-id: your-company-id
    x-user-id: your-user-id
  ingestionServiceBaseUrl: https://ingestion.your-unique-instance.com
  scopeManagementServiceBaseUrl: https://scope-management.your-unique-instance.com
  apiRateLimitPerMinute: 60

processing:
  stepTimeoutSeconds: 300
  concurrency: 5
  maxFileSizeToIngestBytes: 52428800
  allowedMimeTypes:
    - application/pdf
    - application/vnd.openxmlformats-officedocument.wordprocessingml.document
    - application/vnd.openxmlformats-officedocument.spreadsheetml.sheet
    - application/vnd.openxmlformats-officedocument.presentationml.presentation
  scanIntervalCron: "*/15 * * * *"

